<script type="text/javascript">
    $(function() {

 // Below is the name of the textfield that will be autocomplete    
    $('#select_student').autocomplete({
 // This shows the min length of charcters that must be typed before the autocomplete looks for a match.
            minLength: 3,
 // This is the source of the auocomplete suggestions. In this case a list of names from the people controller, in JSON format.
            source: '<%= students_path(:json) %>',
  // This updates the textfield when you move the updown the suggestions list, with your keyboard. 
  // In our case it will reflect the same value that you see in the suggestions which is the person.given_name.
            focus: function(event, ui) {
                $('#select_student').val(ui.item.name);
                return false;
            },
 // Once a value in the drop down list is selected, do the following:
            select: function(event, ui) {
 // place the person.given_name value into the textfield called 'select_origin'...
                $('#select_student').val(ui.item.name);
 // and place the person.id into the hidden textfield called 'link_origin_id'. 
        $('#enrollment_student_id').val(ui.item.id);
                return false;
            }
        })
 // The below code is straight from the jQuery example. It formats what data is displayed in the dropdown box, and can be customized.
        .data( "uiAutocomplete" )._renderItem = function( ul, item ) {
            return $( "<li></li>" )
                .data( "item.autocomplete", item )
 // For now which just want to show the person.given_name in the list.
                .append( "<a>" + item.name + "</a>" )
                .appendTo( ul );
        };
    });
</script>

<br>

<fieldset>
  <% if @enrollment.errors.any? %>
    <div class="alert alert-error">
      <button type="button" class="close" data-dismiss="alert">×</button>
        <ul>
          <% @enrollment.errors.full_messages.each do |msg| %>
            <li><%= msg %></li>
          <% end %>
        </ul>
    </div>
  <% end %>
  
  <%= form_for(@enrollment, :html => { :class => :form }) do |f| %>
  <!-- Place the following text fields in your form, the names are not important. What is important is that they match the 
  names in your javascript above -->
  <!-- This is the textfield that will autocomplete. What is displayed here is for the user to see but the data will not go anywhere -->
  <%= f.label 'Estudante', :class => "control-label" %>
  <%= f.text_field :student_id, :id => "select_student", :class => "input-xlarge", :onkeyup => "toUppercase(this);", :maxlength => "40" %>
  <!-- This is the hidden textfield that will be given the Persons ID based on who is selected. This value will be sent as a parameter -->
  <%= hidden_field(:enrollment, :student_id) %>
  
<!-- # => <input type="hidden" id="student_id" name="student[id]" value="#{@student.id}" /> -->

  <!-- <input id="link_student_id" name="link[student_id]" type="hidden"/> -->
  <!-- end of notes -->
  <br>
  
  <br>
  <%= f.label 'Modalidade', :class => "control-label" %>
  <%= select("enrollment", "modality_id", Modality.all.collect {|p| [ p.name, p.id ] }, {include_blank: '-- Selecione a modalidade --'}, {class: "span4", onchange: "atualizaForm()", id:"idModality"}) %>
  
  <br>
  <%= f.label 'Dia de Vencimento', :class => "control-label" %>
  <%= select_tag 'enrollment', options_for_select((1..28).to_a, disabled: "") %>
  
  
  <br>
  <%= f.label 'Periodicidade', :class => "control-label" %>
  <%= select("enrollment", "periodicity_id", Periodicity.all.collect {|p| [ p.description, p.id ] }, {include_blank: '-- Selecione a periodicidade --'}, {class: "span4", disabled: "disabled", onchange: "atualizaForm()", id:"idModality"}) %>
  
  <br>
  <%= f.label :start_date, t("activerecord.attributes.enrollment.start_date", :default => "Data de Início"), :class => 'control-label' %>
  <%= f.text_field :start_date, :class => 'text_field', :onkeyup => "maskIt(this,event,'##/##/####')", :value => l(Date.today, :format => :sample), :maxlength => "10" %>

  <br>
  <%= f.label 'Taxa de Matrícula', :class => "control-label" %>
  <%= f.text_field :registration_fee, :class => "input-xlarge", :onkeyup => "toUppercase(this);", :maxlength => "10", :onkeyup => "somenteNumero(this, event), formatarValor(this)", :value => "0,00" %>
  
  <br>
  <%= f.label 'Valor', :class => "control-label" %>
  <%= f.text_field :value, :class => "input-xlarge", :onkeyup => "toUppercase(this);", :maxlength => "10", :onkeyup => "somenteNumero(this, event), formatarValor(this)", :value => "0,00" %>
  
  <br>
  <%= f.label 'Desconto', :class => "control-label" %>
  <%= f.text_field :discount, :class => "input-xlarge", :onkeyup => "toUppercase(this);", :maxlength => "10", :onkeyup => "somenteNumero(this, event), formatarValor(this)", :value => "0,00" %>
  
  <br>
  <%= f.label 'Observação', :class => "control-label" %>
  <%= f.text_area :note, :rows => "5", :cols => "45", :class => "span8"   %>
  
  <p>
    <%= f.submit 'Confirmar' %>
    <%= link_to "Cancelar", enrollments_path, :confirm => "Deseja cancelar a operação? Todos os dados serão perdidos." %>
  </p>
<% end %>
  
